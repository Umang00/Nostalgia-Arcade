var G=Object.defineProperty;var q=(n,s,t)=>s in n?G(n,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[s]=t;var a=(n,s,t)=>q(n,typeof s!="symbol"?s+"":s,t);(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))e(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&e(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function e(i){if(i.ep)return;i.ep=!0;const r=t(i);fetch(i.href,r)}})();function O(n){let s=null;window.addEventListener("beforeinstallprompt",t=>{t.preventDefault(),s=t,n&&n.classList.remove("hidden")}),n?.addEventListener("click",async()=>{s&&(s.prompt(),await s.userChoice,s=null,n?.classList.add("hidden"))})}const k={};function W(n){Object.assign(k,n),window.addEventListener("popstate",()=>{I(location.pathname+location.search,!1)}),document.addEventListener("click",s=>{const t=s.target;if(t&&t.closest){const e=t.closest('a[href^="/"]');e&&(s.preventDefault(),I(e.getAttribute("href"),!0))}})}function $(n){for(const s in k){const t=[],e=new RegExp("^"+s.replace(/:[^/]+/g,r=>(t.push(r.slice(1)),"([^/]+)"))+"$"),i=n.match(e);if(i){const r={};return t.forEach((o,u)=>r[o]=decodeURIComponent(i[u+1])),{handler:k[s],params:r}}}return{params:{}}}function I(n,s=!0){const[t]=n.split("?"),{handler:e,params:i}=$(t);s&&history.pushState({},"",n),e?e(i):k["/"]?.({})}class V{constructor(){a(this,"ctx",null);a(this,"master",null);a(this,"musicGain",null);a(this,"muted",!1);a(this,"volume",.5);a(this,"musicTimer",null)}ensure(){if(this.ctx)return;const s=new(window.AudioContext||window.webkitAudioContext),t=s.createGain();t.gain.value=this.getStoredVolume();const e=s.createGain();e.gain.value=.25,e.connect(t),t.connect(s.destination),this.ctx=s,this.master=t,this.musicGain=e;const i=localStorage.getItem("audio_muted");i&&this.setMuted(i==="true")}getStoredVolume(){const s=localStorage.getItem("audio_volume"),t=s?Number(s):this.volume;return this.volume=Math.max(0,Math.min(1,isNaN(t)?.5:t)),this.volume}setMuted(s){this.ensure(),this.muted=s,localStorage.setItem("audio_muted",String(s)),this.master&&(this.master.gain.value=s?0:this.volume)}isMuted(){return this.muted}setVolume(s){this.ensure(),this.volume=Math.max(0,Math.min(1,s)),localStorage.setItem("audio_volume",String(this.volume)),!this.muted&&this.master&&(this.master.gain.value=this.volume)}getVolume(){return this.volume}tone(s,t,e="square",i=.2,r=!1){if(this.ensure(),!this.ctx||!this.master)return;const o=this.ctx.createOscillator(),u=this.ctx.createGain();o.type=e,o.frequency.value=s,u.gain.value=i,r&&this.musicGain?u.connect(this.musicGain):u.connect(this.master),o.connect(u);const y=this.ctx.currentTime;o.start(y),o.stop(y+t/1e3)}play(s){if(!this.muted)switch(s){case"move":this.tone(420,40,"square",.1);break;case"rotate":this.tone(620,60,"triangle",.12);break;case"drop":this.tone(300,60,"square",.14);break;case"hard":this.tone(180,80,"sawtooth",.16);break;case"clear":{this.tone(880,80,"square",.14),setTimeout(()=>this.tone(990,90,"square",.12),60);break}case"gameover":{this.tone(400,150,"sawtooth",.15),setTimeout(()=>this.tone(260,300,"triangle",.12),120);break}}}startMusic(){if(this.ensure(),!this.ctx||this.musicTimer)return;const s=[523,659,784,659,523,587,698,587];let t=0;this.musicTimer=window.setInterval(()=>{this.muted||(this.tone(s[t%s.length],140,"triangle",.08,!0),t++)},180)}stopMusic(){this.musicTimer&&(clearInterval(this.musicTimer),this.musicTimer=null)}}const d=new V,_=[{id:"snake",name:"Snake",tagline:"Classic Nokia vibes"},{id:"tetris",name:"Tetris",tagline:"Stack & clear lines"},{id:"pong",name:"Pong",tagline:"Retro paddle duel"},{id:"brick",name:"Brick Breaker",tagline:"Smash those bricks"}];function K(){const n=document.getElementById("route-root");n.innerHTML=`
    <h1 style="margin:8px 0 12px 0;">All your childhood games, one link.</h1>
    <div class="controls" style="margin-bottom:10px; align-items:center;">
      <button id="btnAudioMute" class="btn secondary"></button>
      <input id="rangeVolume" type="range" min="0" max="1" step="0.01" style="width:160px;" />
    </div>
    <div class="grid">
      ${_.map(i=>`
        <div class="card">
          <div style="font-weight:600;">${i.name}</div>
          <div class="pill">${i.tagline}</div>
          <button class="btn" data-game="${i.id}">Play</button>
        </div>
      `).join("")}
    </div>
  `;const s=n.querySelector("#btnAudioMute"),t=n.querySelector("#rangeVolume"),e=()=>s.textContent=d.isMuted()?"Unmute":"Mute";e(),t.value=String(d.getVolume()),s.addEventListener("click",()=>{d.setMuted(!d.isMuted()),e()}),t.addEventListener("input",()=>d.setVolume(Number(t.value))),d.startMusic(),n.querySelectorAll("button[data-game]").forEach(i=>{i.addEventListener("click",()=>{const r=i.dataset.game;I(`/game/${r}`)})})}class F{constructor(){a(this,"listeners",{score:[],game_over:[],share_payload:[]});a(this,"container")}on(s,t){this.listeners[s].push(t)}emit(s,...t){this.listeners[s].forEach(e=>e(...t))}init(s){this.container=s}}class M extends F{constructor(){super(...arguments);a(this,"canvas");a(this,"ctx");a(this,"grid",20);a(this,"snake",[]);a(this,"dir",{x:1,y:0});a(this,"food",{x:10,y:10});a(this,"raf",0);a(this,"last",0);a(this,"speedMs",120);a(this,"paused",!1);a(this,"alive",!0);a(this,"onVirtualDir",t=>{const e=t.detail;this.applyDir(e)});a(this,"handleKeys",t=>{["ArrowUp","KeyW"].includes(t.code)?this.applyDir("up"):["ArrowDown","KeyS"].includes(t.code)?this.applyDir("down"):["ArrowLeft","KeyA"].includes(t.code)?this.applyDir("left"):["ArrowRight","KeyD"].includes(t.code)?this.applyDir("right"):t.code==="Space"&&(this.paused?this.resume():this.pause())})}init(t){super.init(t),this.canvas=document.createElement("canvas"),this.canvas.className="game-canvas",this.ctx=this.canvas.getContext("2d"),t.innerHTML="",t.appendChild(this.canvas),this.onResize(),addEventListener("resize",()=>this.onResize()),this.reset(),addEventListener("keydown",this.handleKeys),addEventListener("virtual-direction",this.onVirtualDir)}applyDir(t){const e={up:{x:0,y:-1},down:{x:0,y:1},left:{x:-1,y:0},right:{x:1,y:0}}[t];this.snake.length>1&&this.dir.x+e.x===0&&this.dir.y+e.y===0||(this.dir=e)}onResize(){const t=this.container.getBoundingClientRect(),e=Math.min(t.width,t.height);this.canvas.width=Math.floor(e),this.canvas.height=Math.floor(e)}start(){this.paused=!1,this.alive=!0,this.last=0,cancelAnimationFrame(this.raf);const t=e=>{this.raf=requestAnimationFrame(t),!(this.paused||!this.alive)&&(this.last||(this.last=e),e-this.last>this.speedMs&&(this.step(),this.last=e,this.draw()))};this.raf=requestAnimationFrame(t)}pause(){this.paused=!0}resume(){this.paused=!1}reset(){this.snake=[{x:5,y:5},{x:4,y:5},{x:3,y:5}],this.dir={x:1,y:0},this.randomFood(),this.alive=!0,this.draw()}destroy(){cancelAnimationFrame(this.raf),removeEventListener("keydown",this.handleKeys),removeEventListener("virtual-direction",this.onVirtualDir),this.container.innerHTML=""}cellsX(){return Math.floor(this.canvas.width/this.grid)}cellsY(){return Math.floor(this.canvas.height/this.grid)}randomFood(){this.food={x:Math.floor(Math.random()*this.cellsX()),y:Math.floor(Math.random()*this.cellsY())}}step(){const t={x:this.snake[0].x+this.dir.x,y:this.snake[0].y+this.dir.y};if(t.x=(t.x+this.cellsX())%this.cellsX(),t.y=(t.y+this.cellsY())%this.cellsY(),this.snake.some((e,i)=>i>0&&e.x===t.x&&e.y===t.y)){this.alive=!1,this.emit("game_over");return}this.snake.unshift(t),t.x===this.food.x&&t.y===this.food.y?(this.emit("score",10),this.randomFood()):this.snake.pop()}draw(){const t=this.ctx;t.clearRect(0,0,this.canvas.width,this.canvas.height),t.fillStyle="#0f1220",t.fillRect(0,0,this.canvas.width,this.canvas.height),t.fillStyle="#f59e0b",t.fillRect(this.food.x*this.grid,this.food.y*this.grid,this.grid-1,this.grid-1),t.fillStyle="#60a5fa";for(const e of this.snake)t.fillRect(e.x*this.grid,e.y*this.grid,this.grid-1,this.grid-1)}}const z={I:{name:"I",color:"#60a5fa",cells:[{x:-1,y:0},{x:0,y:0},{x:1,y:0},{x:2,y:0}]},O:{name:"O",color:"#fbbf24",cells:[{x:0,y:0},{x:1,y:0},{x:0,y:1},{x:1,y:1}]},T:{name:"T",color:"#a78bfa",cells:[{x:-1,y:0},{x:0,y:0},{x:1,y:0},{x:0,y:1}]},S:{name:"S",color:"#34d399",cells:[{x:0,y:0},{x:1,y:0},{x:-1,y:1},{x:0,y:1}]},Z:{name:"Z",color:"#f87171",cells:[{x:-1,y:0},{x:0,y:0},{x:0,y:1},{x:1,y:1}]},J:{name:"J",color:"#60a5fa",cells:[{x:-1,y:0},{x:0,y:0},{x:1,y:0},{x:-1,y:1}]},L:{name:"L",color:"#f59e0b",cells:[{x:-1,y:0},{x:0,y:0},{x:1,y:0},{x:1,y:1}]}};function B(n){return z[n]}function Y(n,s){if(s==="O")return n.map(e=>({...e}));const t=new Array(n.length);for(let e=0;e<n.length;e++){const i=n[e];t[e]={x:i.y,y:-i.x}}return t}const j=[{x:0,y:0},{x:1,y:0},{x:-1,y:0},{x:0,y:-1}];class N{constructor(){a(this,"queue",[])}next(){return this.queue.length===0&&this.refill(),this.queue.pop()}peekNext(){return this.queue.length===0&&this.refill(),this.queue[this.queue.length-1]}refill(){const s=["I","O","T","S","Z","J","L"];for(let t=s.length-1;t>0;t--){const e=Math.floor(Math.random()*(t+1));[s[t],s[e]]=[s[e],s[t]]}this.queue.push(...s)}}const J=[0,100,300,500,800];function X(n){return J[n]||0}function U(n){return n*2}function Z(n,s,t){const e=s+t;return{level:Math.floor(e/10),totalLines:e}}function Q(n){const i=800-85*Math.max(0,n);return Math.max(120,i)}class tt extends F{constructor(){super(...arguments);a(this,"canvas");a(this,"ctx");a(this,"boardW",10);a(this,"boardH",20);a(this,"hiddenRows",2);a(this,"grid",24);a(this,"board",[]);a(this,"bag",new N);a(this,"active");a(this,"nextShape");a(this,"raf",0);a(this,"lastFrame",0);a(this,"lastGravity",0);a(this,"running",!1);a(this,"paused",!1);a(this,"over",!1);a(this,"level",0);a(this,"totalLines",0);a(this,"score",0);a(this,"touchRotateListener",t=>{this.rotate()});a(this,"onVirtual",t=>{const e=t.detail;e==="left"?this.move(-1):e==="right"?this.move(1):e==="down"&&this.softDrop()});a(this,"onKey",t=>{t.code==="ArrowLeft"?this.move(-1):t.code==="ArrowRight"?this.move(1):t.code==="ArrowDown"?this.softDrop():t.code==="ArrowUp"?this.rotate():t.code==="Space"?this.hardDrop():t.code==="KeyP"&&(this.paused?this.resume():this.pause())})}init(t){super.init(t),this.canvas=document.createElement("canvas"),this.canvas.className="game-canvas",this.ctx=this.canvas.getContext("2d"),t.innerHTML="",t.appendChild(this.canvas),this.onResize(),addEventListener("resize",()=>this.onResize()),addEventListener("keydown",this.onKey),addEventListener("virtual-direction",this.onVirtual),this.canvas.addEventListener("click",this.touchRotateListener),this.reset()}start(){if(this.running)return;this.paused=!1,this.over=!1,this.running=!0,cancelAnimationFrame(this.raf),this.lastFrame=0,this.lastGravity=0;const t=e=>{if(this.raf=requestAnimationFrame(t),this.paused||this.over)return;if(!this.lastFrame){this.lastFrame=e,this.lastGravity=e,this.draw();return}const i=Q(this.level);e-this.lastGravity>=i&&(this.tryMove(0,1)||this.lockPiece(),this.lastGravity=e),e-this.lastFrame>=16&&(this.draw(),this.lastFrame=e)};this.raf=requestAnimationFrame(t)}pause(){this.running&&(this.paused=!0)}resume(){this.running&&(this.paused=!1)}reset(){const t=this.boardH+this.hiddenRows;this.board=new Array(t);for(let e=0;e<t;e++){const i=new Array(this.boardW);for(let r=0;r<this.boardW;r++)i[r]={filled:!1,color:"#000000"};this.board[e]=i}this.level=0,this.totalLines=0,this.score=0,this.bag=new N,this.nextShape=this.bag.next(),this.spawn(),this.running=!1,this.over=!1,this.paused=!1,this.draw()}destroy(){cancelAnimationFrame(this.raf),removeEventListener("keydown",this.onKey),removeEventListener("virtual-direction",this.onVirtual),this.canvas.removeEventListener("click",this.touchRotateListener),this.container.innerHTML="",this.running=!1}onResize(){const t=this.container.getBoundingClientRect(),e=Math.floor(Math.min(t.width/this.boardW,t.height/this.boardH)),i=e*this.boardW,r=e*this.boardH;this.canvas.width=i,this.canvas.height=r,this.grid=e;const o=this.container;o.style.display="flex",o.style.alignItems="center",o.style.justifyContent="center"}spawn(){const t=this.nextShape;this.nextShape=this.bag.next();const e=B(t);this.active={shape:t,cells:e.cells.map(i=>({...i})),x:Math.floor(this.boardW/2),y:0,color:e.color},this.collides(this.active,0,0)&&this.gameOver()}gameOver(){this.over=!0,this.running=!1,this.emit("game_over")}tryMove(t,e){return this.collides(this.active,t,e)?!1:(this.active.x+=t,this.active.y+=e,!0)}move(t){this.tryMove(t,0)}rotate(){const t=Y(this.active.cells,this.active.shape),e={...this.active,cells:t};for(const i of j)if(!this.collides(e,i.x,i.y)){this.active.cells=t,this.active.x+=i.x,this.active.y+=i.y,d.play("rotate");return}}softDrop(){!this.over&&!this.paused&&(this.tryMove(0,1)?(this.incrementScore(1),d.play("drop"),this.lastGravity=performance.now()):this.lockPiece())}hardDrop(){if(this.over||this.paused)return;let t=0;for(;this.tryMove(0,1);)t++;t>0&&this.incrementScore(U(t)),d.play("hard"),this.lockPiece()}incrementScore(t){t<=0||(this.score+=t,this.emit("score",t))}lockPiece(){const t=this.active;for(const i of t.cells){const r=t.x+i.x,o=t.y+i.y;o<0||o>=this.board.length||r<0||r>=this.boardW||(this.board[o][r]={filled:!0,color:t.color})}const e=this.clearLines();if(e>0){const i=X(e);this.incrementScore(i),d.play("clear");const r=Z(this.level,this.totalLines,e);this.level=r.level,this.totalLines=r.totalLines}this.spawn()}clearLines(){let t=0;for(let e=this.board.length-1;e>=0;e--)this.isLineFull(e)&&(this.removeLine(e),t++,e++);return t}isLineFull(t){for(let e=0;e<this.boardW;e++)if(!this.board[t][e].filled)return!1;return!0}removeLine(t){for(let e=t;e>0;e--)for(let i=0;i<this.boardW;i++)this.board[e][i]={...this.board[e-1][i]};for(let e=0;e<this.boardW;e++)this.board[0][e]={filled:!1,color:"#000000"}}collides(t,e,i){for(const r of t.cells){const o=t.x+r.x+e,u=t.y+r.y+i;if(o<0||o>=this.boardW||u>=this.board.length||u>=0&&this.board[u][o].filled)return!0}return!1}computeGhostY(){const t={...this.active,cells:this.active.cells.map(i=>({...i}))};let e=t.y;for(;!this.collides(t,0,1);)t.y++,e=t.y;return e}draw(){const t=this.ctx,e=this.canvas.width,i=this.canvas.height;t.clearRect(0,0,e,i),t.fillStyle="#0f1220",t.fillRect(0,0,e,i),this.hiddenRows*this.grid,t.strokeStyle="rgba(255,255,255,0.06)",t.lineWidth=1;for(let l=0;l<=this.boardW;l++)t.beginPath(),t.moveTo(l*this.grid+.5,.5),t.lineTo(l*this.grid+.5,this.boardH*this.grid+.5),t.stroke();for(let l=0;l<=this.boardH;l++)t.beginPath(),t.moveTo(.5,l*this.grid+.5),t.lineTo(this.boardW*this.grid+.5,l*this.grid+.5),t.stroke();for(let l=this.hiddenRows;l<this.board.length;l++)for(let m=0;m<this.boardW;m++){const f=this.board[l][m];f.filled&&(t.fillStyle=f.color,t.fillRect(m*this.grid,(l-this.hiddenRows)*this.grid,this.grid-1,this.grid-1))}const r=this.computeGhostY();t.fillStyle="rgba(255,255,255,0.12)";for(const l of this.active.cells){const m=(this.active.x+l.x)*this.grid,f=(r+l.y-this.hiddenRows)*this.grid;r+l.y>=this.hiddenRows&&t.fillRect(m,f,this.grid-1,this.grid-1)}t.fillStyle=this.active.color;for(const l of this.active.cells){const m=(this.active.x+l.x)*this.grid,f=(this.active.y+l.y-this.hiddenRows)*this.grid;this.active.y+l.y>=this.hiddenRows&&t.fillRect(m,f,this.grid-1,this.grid-1)}const o=Math.max(10,Math.floor(this.grid*.85)),u=8,y=e-o*4-u,x=u;t.save(),t.globalCompositeOperation="source-over",t.fillStyle="rgba(255,255,255,0.06)",t.fillRect(y,x,o*4,o*4);const h=B(this.nextShape);t.fillStyle=h.color;const b=y+o*2,g=x+o*2;for(const l of h.cells){const m=b+l.x*o-o/2,f=g+l.y*o-o/2;t.fillRect(m,f,o-2,o-2)}t.restore()}}function et(n){switch(n){case"snake":return new M;case"tetris":return new tt;case"pong":return new M;case"brick":return new M;default:return new M}}function R(n,s={}){console.log("[analytics]",n,s);const t=window;t.plausible&&t.plausible(n,{props:s})}function st(n){const s=n?.id||"snake",t=document.getElementById("route-root");t.innerHTML=`
    <a class="btn secondary" href="/">← Back</a>
    <div style="margin-top:10px;"></div>
    <div id="game-wrap" class="card" style="height:70vh; display:flex; flex-direction:column;">
      <div id="hud" style="display:flex; align-items:center; justify-content:space-between; gap:8px; margin-bottom:8px;">
        <div>Score: <span id="score">0</span></div>
        <div>Best: <span id="best">0</span></div>
        <div class="controls">
          <button id="btnPause" class="btn secondary">Pause</button>
          <button id="btnReset" class="btn secondary">Reset</button>
          <button id="btnMute" class="btn secondary">Mute</button>
          <input id="rangeVol" type="range" min="0" max="1" step="0.01" style="width:120px;" />
        </div>
      </div>
      <div id="canvasHost" style="flex:1; position:relative; display:flex; align-items:center; justify-content:center;"></div>
      <div id="centerOverlay" class="overlay-card hidden" style="position:absolute; left:50%; top:50%; transform:translate(-50%,-50%); z-index:5;"></div>
      <div id="touchControls" class="controls" style="justify-content:center; margin-top:8px;">
        <button class="btn secondary" data-dir="up">↑</button>
        <div>
          <button class="btn secondary" data-dir="left">←</button>
          <button class="btn secondary" data-dir="right">→</button>
        </div>
        <button class="btn secondary" data-dir="down">↓</button>
      </div>
    </div>
    <div id="endModal" class="card hidden"><!-- kept for accessibility; overlay used for center message --></div>
  `;const e=`best_${s}`,i=document.getElementById("best");i.textContent=String(Number(localStorage.getItem(e)||"0"));const r=document.getElementById("canvasHost"),o=et(s);o.init(r);const u=document.getElementById("btnMute"),y=document.getElementById("rangeVol"),x=()=>u.textContent=d.isMuted()?"Unmute":"Mute";x(),y.value=String(d.getVolume()),u.addEventListener("click",()=>{d.setMuted(!d.isMuted()),x()}),y.addEventListener("input",()=>d.setVolume(Number(y.value)));let h=0;const b=document.getElementById("score");let g=!1,l;o.on("score",c=>{h+=c,b.textContent=String(h)}),o.on("game_over",()=>{const c=Number(localStorage.getItem(e)||"0"),v=h>c;v&&localStorage.setItem(e,String(h));const p=Number(localStorage.getItem(e)||"0");i.textContent=String(p),document.getElementById("finalScore").textContent=String(h);const E=document.getElementById("endMessage");v?E.textContent=`Yess! New best score: ${h} 🎉 Now try to beat this one—hit Play Again.`:E.textContent=`Wooo! You scored ${h} but didn’t beat your best ${p}. Click Play Again and crush it.`;const T=document.getElementById("centerOverlay");T.innerHTML=`
      <div style="font-size:18px; font-weight:700; text-align:center; margin-bottom:8px;">Game Over</div>
      <div style="text-align:center; margin-bottom:6px;">Final Score: <b>${h}</b></div>
      <div id="endMessage" style="margin:6px 0 10px 0; max-width:260px; text-align:center;"></div>
      <div style="display:flex; gap:8px; justify-content:center;">
        <button id="btnPlayAgain" class="btn">Play Again</button>
        <button id="btnShare" class="btn secondary">Share</button>
      </div>
    `,T.classList.remove("hidden"),R("game_end",{id:s,score:h}),d.stopMusic(),d.play("gameover")}),o.on("share_payload",c=>{l=typeof c=="string"?c:c?.text,console.log("share payload",c)});const m=document.getElementById("btnPause");m.addEventListener("click",()=>{g?(o.resume(),g=!1,m.textContent="Pause"):(o.pause(),g=!0,m.textContent="Resume")}),document.getElementById("btnReset").addEventListener("click",()=>{h=0,b.textContent="0",g=!1,m.textContent="Pause",o.reset(),o.start(),d.startMusic()});const f=()=>{h=0,b.textContent="0",g=!1,m.textContent="Pause",document.getElementById("centerOverlay").classList.add("hidden"),o.reset(),o.start(),d.startMusic()};document.addEventListener("click",c=>{const v=c.target;v&&v.id==="btnPlayAgain"&&f()}),document.getElementById("btnShare").addEventListener("click",async()=>{const v=`Just scored ${h} in ${s==="tetris"?"Tetris":s==="snake"?"Snake":s} at Nostalgia Arcade! Can you beat me? 🎮
Play here: ${location.origin}/`,p=l||v,E=location.origin+"/";if(navigator.share)try{await navigator.share({title:"Nostalgia Arcade",text:p,url:E})}catch{}else await navigator.clipboard.writeText(p),alert("Share text copied to clipboard!");R("share_clicked",{id:s,score:h})});const w=document.createElement("div");w.className="card",w.style.marginTop="8px",w.innerHTML=`
    <div style="font-weight:600; margin-bottom:6px;">Share prompts</div>
    <div style="display:flex; gap:8px; flex-direction:column;">
      <button class="btn secondary" id="copyPromptA">Copy: Just scored…</button>
      <button class="btn secondary" id="copyPromptB">Copy: I'm loving…</button>
    </div>
  `,document.getElementById("game-wrap").appendChild(w);const C=async c=>{await navigator.clipboard.writeText(c),alert("Copied to clipboard!")};document.getElementById("copyPromptA").addEventListener("click",()=>{C(`Just scored ${h} in ${s==="tetris"?"Tetris":s==="snake"?"Snake":s} at Nostalgia Arcade! Can you beat me? 🎮
Play here: ${location.origin}/`)}),document.getElementById("copyPromptB").addEventListener("click",()=>{C(`I'm just loving the ${s==="tetris"?"Tetris":s==="snake"?"Snake":s} game at Nostalgia Arcade!
Do you also want to play?
Play here: ${location.origin}/`)}),document.querySelectorAll("#touchControls [data-dir]").forEach(c=>{c.addEventListener("click",()=>{const v=c.dataset.dir,p=new CustomEvent("virtual-direction",{detail:v});window.dispatchEvent(p)})});const A=document.querySelector('#touchControls [data-dir="down"]');let L,S;const P=()=>{L=window.setTimeout(()=>{S=window.setInterval(()=>{const c=new CustomEvent("virtual-direction",{detail:"down"});window.dispatchEvent(c)},60)},200)},H=()=>{L&&(clearTimeout(L),L=void 0),S&&(clearInterval(S),S=void 0)};A.addEventListener("mousedown",P),A.addEventListener("touchstart",P,{passive:!0}),["mouseup","mouseleave","touchend","touchcancel"].forEach(c=>A.addEventListener(c,H)),o.start(),R("game_start",{id:s})}W({"/":K,"/game/:id":st});const D=document.getElementById("installPwaBtn");D instanceof HTMLButtonElement&&O(D);"serviceWorker"in navigator&&navigator.serviceWorker.register("/sw.js");I(location.pathname+location.search);
